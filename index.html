<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Fonctions Holomorphes</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="css/styles.css" type="text/css" />
</head>
<body>

    <div class="container">
        <header>
            <h1>Fonctions Holomorphes</h1>
        </header>


        <div id="supports">
            <canvas id="support-domaine" width="350px" height="350px"></canvas>
            <canvas id="support-image" width="350px" height="350px"></canvas>

            <br style="clear:both;" />
        </div>

        <div id="function">
            <!-- $$f(z) = \frac{x^2-y^2}{x-1} + i \frac{2xy}{y-2}$$ -->
            <div id="function-display">
                $$f(z) = 2\ln(z+1)-z^3\frac{x+i}{3z}$$
            </div>
            $$z = x+iy, \qquad x,y \in \mathbb R $$

            <textarea id="user-input" onkeyup="onUserInputFunction(this);">2\ln(z+1)-z^3\frac{x+i}{3z}</textarea>
        </div>

    </div>


    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
    <script src="js/complexe.js"></script>
    <script src="js/utest-complexe.js"></script>
    <script src="js/scripts.js"></script>

    <script>

        function onUserInputFunction(textarea)
        {
            var display = document.getElementById("function-display");
            display.innerHTML = "$$ f(z)="+textarea.value+"$$"

            MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
        }


        var z = new Complexe(-1,2);
        console.log(z);
        console.log(z.module());
        console.log(z.argument());

        console.log(cplx);

        // On aimerai créer la fonction
        // f(z) = 2*ln(z+1) - z^3*(x+i)/(3z)

        /*

            f(z) se décompose en :

            (-){
                (*){
                    2,
                    ln(){
                        +(){
                            z,
                            1
                        },
                        null
                    }
                },
                (/){
                    (*){
                        pow(){
                            z,
                            3
                        },
                        (+){
                            re(){
                                z,
                                null
                            },
                            i
                        }
                    },
                    (*){
                        3,
                        z
                    }
                }
            }


        */

        var g = cplx.z;
        console.log(g.evaluate(z));


        //*
        // Construction de f(z)
        f = cplx.minus(
            cplx.times(
                cplx.complexe(2,0),
                cplx.ln(
                    cplx.plus(
                        cplx.z,
                        cplx.complexe(1,0)
                    )
                    // pas de 2ème argument pour ln()
                )
            ),
            cplx.frac(
                cplx.times(
                    cplx.pow(
                        cplx.z,
                        cplx.complexe(3,0)
                    ),
                    cplx.plus(
                        cplx.re(
                            cplx.z
                            // pas de 2ème argument pour la partie réel
                        ),
                        cplx.complexe(0,1)
                    )
                ),
                cplx.times(
                    cplx.complexe(3,0),
                    cplx.z
                )
            )
        );

        // Evaluation
        var w = f.evaluate(z);
        console.log(w);

        //*/

        // Ancienne fonction f(z)
        /*
        f = cplx.plus(
            cplx.frac(
                cplx.minus(
                    cplx.pow(cplx.re(cplx.z), cplx.complexe(2,0)),
                    cplx.pow(cplx.im(cplx.z), cplx.complexe(2,0))
                ),
                cplx.minus(
                    cplx.re(cplx.z),
                    cplx.complexe(1,0)
                )
            ),
            cplx.frac(
                cplx.times(
                    cplx.complexe(2,0),
                    cplx.times(cplx.re(cplx.z), cplx.im(cplx.z))
                ),
                cplx.minus(
                    cplx.im(cplx.z),
                    cplx.complexe(2,0)
                )
            )
        );
        //*/

        // debug
        /*
        f = cplx.minus(
            cplx.pow(cplx.re(cplx.z), cplx.complexe(2,0)),
            cplx.pow(cplx.im(cplx.z), cplx.complexe(2,0))
        );
        //*/

        var p = new Complexe(2,2);
        console.log("debug");
        console.log(f.evaluate(p));
        console.log(toString(f.evaluate(p)))


        function_to_draw = f;
        draw(support_domaine);

        console.log(f);
        console.log(f.toLatex())
    </script>
</body>
</html>
